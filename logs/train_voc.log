2024-07-29 11:19:27,540 - test_du_instance.py - INFO: Pytorch version: 2.2.0+cu118
2024-07-29 11:19:27,631 - test_du_instance.py - INFO: GPU type: NVIDIA GeForce RTX 4090
2024-07-29 11:19:27,631 - test_du_instance.py - INFO: 
args: Namespace(backbone='vit_base_patch16_224', pooling='gmp', pretrained=True, data_folder='../VOC2012', list_folder='../datasets/voc', num_classes=21, crop_size=448, local_crop_size=96, local_crop_num=1, ignore_index=255, work_dir='work_dir_voc_wseg/2024-07-29-11-19-27-539801', train_set='train_aug', val_set='val', spg=4, scales=(0.5, 2), optimizer='PolyWarmupAdamW', lr=6e-05, warmup_lr=6e-06, wt_decay=0.01, betas=(0.9, 0.999), power=0.9, max_iters=8000, log_iters=200, eval_iters=2000, warmup_iters=1500, high_thre=0.7, low_thre=0.25, bkg_thre=0.5, cam_scales=(1.0, 0.5, 0.75, 1.5), w_ptc=0.2, w_ctc=0.45, w_seg=0.17, w_reg=0.05, uncertain_region_thre=0.2, t_b1_mix_cam=0.7, t_b2_mix_cam=0.5, temp=0.5, momentum=0.9, aux_layer=-3, seed=0, save_ckpt=True, local_rank=0, num_workers=10, backend='nccl', ckpt_dir='work_dir_voc_wseg/2024-07-29-11-19-27-539801/checkpoints', pred_dir='work_dir_voc_wseg/2024-07-29-11-19-27-539801/predictions')
2024-07-29 11:19:27,633 - test_du_instance.py - INFO: Total gpus: 3, samples per gpu: 4...
2024-07-29 11:19:30,861 - test_du_instance.py - INFO: 
Optimizer: 
PolyWarmupAdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00012
    maximize: False
    weight_decay: 0.01

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00012
    maximize: False
    weight_decay: 0.01

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0006000000000000001
    maximize: False
    weight_decay: 0.01

Parameter Group 3
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0006000000000000001
    maximize: False
    weight_decay: 0.01
)
2024-07-29 11:25:18,732 - test_du_instance.py - INFO: Iter: 200; Elasped: 0:05:51; ETA: 3:48:09; LR: 1.592e-05; cls_loss: 0.4379, cls_loss_aux: 7.4460, ptc_loss: 0.8885, spacial_bce_loss: 0.5751..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 11:31:05,790 - test_du_instance.py - INFO: Iter: 400; Elasped: 0:11:38; ETA: 3:41:02; LR: 3.192e-05; cls_loss: 0.2295, cls_loss_aux: 0.2860, ptc_loss: 0.9475, spacial_bce_loss: 0.3210..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 11:36:52,766 - test_du_instance.py - INFO: Iter: 600; Elasped: 0:17:25; ETA: 3:34:48; LR: 4.792e-05; cls_loss: 0.1805, cls_loss_aux: 0.1998, ptc_loss: 0.9257, spacial_bce_loss: 0.3402..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 11:42:39,669 - test_du_instance.py - INFO: Iter: 800; Elasped: 0:23:12; ETA: 3:28:48; LR: 6.392e-05; cls_loss: 0.1307, cls_loss_aux: 0.1520, ptc_loss: 0.8369, spacial_bce_loss: 0.3791..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 11:48:27,488 - test_du_instance.py - INFO: Iter: 1000; Elasped: 0:29:00; ETA: 3:23:00; LR: 7.992e-05; cls_loss: 0.1122, cls_loss_aux: 0.1302, ptc_loss: 0.4244, spacial_bce_loss: 0.4857..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 11:54:14,202 - test_du_instance.py - INFO: Iter: 1200; Elasped: 0:34:47; ETA: 3:17:06; LR: 9.592e-05; cls_loss: 0.0972, cls_loss_aux: 0.1184, ptc_loss: 0.2637, spacial_bce_loss: 0.5380..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:00:00,441 - test_du_instance.py - INFO: Iter: 1400; Elasped: 0:40:33; ETA: 3:11:09; LR: 1.119e-04; cls_loss: 0.0825, cls_loss_aux: 0.1105, ptc_loss: 0.2107, spacial_bce_loss: 0.5371..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:05:47,012 - test_du_instance.py - INFO: Iter: 1600; Elasped: 0:46:20; ETA: 3:05:20; LR: 9.818e-05; cls_loss: 0.0864, cls_loss_aux: 0.1142, ptc_loss: 0.1886, spacial_bce_loss: 0.5330..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:11:34,417 - test_du_instance.py - INFO: Iter: 1800; Elasped: 0:52:07; ETA: 2:59:30; LR: 9.541e-05; cls_loss: 0.0756, cls_loss_aux: 0.0994, ptc_loss: 0.1657, spacial_bce_loss: 0.5782..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:17:21,288 - test_du_instance.py - INFO: Iter: 2000; Elasped: 0:57:54; ETA: 2:53:42; LR: 9.264e-05; cls_loss: 0.0651, cls_loss_aux: 0.0793, ptc_loss: 0.1335, spacial_bce_loss: 0.5596..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:17:21,288 - test_du_instance.py - INFO: Validating...branch1
2024-07-29 12:20:14,821 - test_du_instance.py - INFO: val cls score: 0.895292
2024-07-29 12:20:14,821 - test_du_instance.py - INFO: 
+--------------+--------+---------+----------+
|    Class     |  CAM   | aux_CAM | Seg_Pred |
+==============+========+=========+==========+
| _background_ | 86.719 | 87.189  | 24.323   |
+--------------+--------+---------+----------+
| aeroplane    | 53.898 | 55.654  | 0.028    |
+--------------+--------+---------+----------+
| bicycle      | 35.809 | 39.041  | 0.030    |
+--------------+--------+---------+----------+
| bird         | 63.957 | 66.294  | 0.404    |
+--------------+--------+---------+----------+
| boat         | 48.234 | 48.335  | 0        |
+--------------+--------+---------+----------+
| bottle       | 53.731 | 51.825  | 0.755    |
+--------------+--------+---------+----------+
| bus          | 80.925 | 75.995  | 0.469    |
+--------------+--------+---------+----------+
| car          | 77.033 | 72.527  | 0.769    |
+--------------+--------+---------+----------+
| cat          | 84.033 | 79.010  | 0.543    |
+--------------+--------+---------+----------+
| chair        | 41.419 | 37.319  | 1.076    |
+--------------+--------+---------+----------+
| cow          | 81.332 | 74.984  | 1.681    |
+--------------+--------+---------+----------+
| diningtable  | 48.549 | 51.324  | 0.002    |
+--------------+--------+---------+----------+
| dog          | 80.537 | 81.027  | 2.512    |
+--------------+--------+---------+----------+
| horse        | 78.074 | 72.749  | 1.005    |
+--------------+--------+---------+----------+
| motorbike    | 67.839 | 73.757  | 0.060    |
+--------------+--------+---------+----------+
| person       | 74.949 | 74.661  | 0        |
+--------------+--------+---------+----------+
| pottedplant  | 47.800 | 52.987  | 0        |
+--------------+--------+---------+----------+
| sheep        | 77.207 | 78.170  | 0.557    |
+--------------+--------+---------+----------+
| sofa         | 47.709 | 68.765  | 0.554    |
+--------------+--------+---------+----------+
| train        | 56.061 | 44.006  | 0.034    |
+--------------+--------+---------+----------+
| tvmonitor    | 40.289 | 53.238  | 0.066    |
+--------------+--------+---------+----------+
| mIoU         | 63.148 | 63.755  | 1.660    |
+--------------+--------+---------+----------+
2024-07-29 12:20:14,821 - test_du_instance.py - INFO: Validating...branch2
2024-07-29 12:23:08,563 - test_du_instance.py - INFO: val cls score: 0.892963
2024-07-29 12:23:08,564 - test_du_instance.py - INFO: 
+--------------+--------+---------+----------+
|    Class     |  CAM   | aux_CAM | Seg_Pred |
+==============+========+=========+==========+
| _background_ | 88.102 | 87.376  | 1.421    |
+--------------+--------+---------+----------+
| aeroplane    | 66.768 | 67.871  | 0.595    |
+--------------+--------+---------+----------+
| bicycle      | 39.326 | 40.068  | 0.024    |
+--------------+--------+---------+----------+
| bird         | 73.113 | 65.156  | 0.051    |
+--------------+--------+---------+----------+
| boat         | 32.106 | 31.617  | 1.138    |
+--------------+--------+---------+----------+
| bottle       | 65.190 | 64.948  | 0.235    |
+--------------+--------+---------+----------+
| bus          | 83.656 | 78.913  | 0.056    |
+--------------+--------+---------+----------+
| car          | 79.089 | 66.658  | 1.375    |
+--------------+--------+---------+----------+
| cat          | 85.292 | 80.386  | 0.746    |
+--------------+--------+---------+----------+
| chair        | 43.596 | 33.772  | 1.285    |
+--------------+--------+---------+----------+
| cow          | 82.520 | 74.928  | 0.886    |
+--------------+--------+---------+----------+
| diningtable  | 46.556 | 54.230  | 0.036    |
+--------------+--------+---------+----------+
| dog          | 83.208 | 80.854  | 1.037    |
+--------------+--------+---------+----------+
| horse        | 78.618 | 75.645  | 1.693    |
+--------------+--------+---------+----------+
| motorbike    | 69.492 | 70.322  | 1.420    |
+--------------+--------+---------+----------+
| person       | 76.841 | 76.018  | 0.998    |
+--------------+--------+---------+----------+
| pottedplant  | 48.907 | 45.287  | 0.001    |
+--------------+--------+---------+----------+
| sheep        | 81.500 | 80.324  | 0        |
+--------------+--------+---------+----------+
| sofa         | 61.514 | 69.431  | 0.896    |
+--------------+--------+---------+----------+
| train        | 61.531 | 56.283  | 0.802    |
+--------------+--------+---------+----------+
| tvmonitor    | 47.422 | 59.612  | 0.436    |
+--------------+--------+---------+----------+
| mIoU         | 66.397 | 64.748  | 0.721    |
+--------------+--------+---------+----------+
2024-07-29 12:28:55,566 - test_du_instance.py - INFO: Iter: 2200; Elasped: 1:09:28; ETA: 3:03:08; LR: 8.986e-05; cls_loss: 0.0784, cls_loss_aux: 0.0950, ptc_loss: 0.1695, spacial_bce_loss: 0.4799..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:34:42,126 - test_du_instance.py - INFO: Iter: 2400; Elasped: 1:15:15; ETA: 2:55:35; LR: 8.706e-05; cls_loss: 0.0748, cls_loss_aux: 0.0964, ptc_loss: 0.1443, spacial_bce_loss: 0.4919..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:40:28,390 - test_du_instance.py - INFO: Iter: 2600; Elasped: 1:21:01; ETA: 2:48:15; LR: 8.426e-05; cls_loss: 0.0669, cls_loss_aux: 0.0828, ptc_loss: 0.1344, spacial_bce_loss: 0.4695..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:46:16,060 - test_du_instance.py - INFO: Iter: 2800; Elasped: 1:26:49; ETA: 2:41:13; LR: 8.145e-05; cls_loss: 0.0646, cls_loss_aux: 0.0770, ptc_loss: 0.1204, spacial_bce_loss: 0.4741..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:52:02,723 - test_du_instance.py - INFO: Iter: 3000; Elasped: 1:32:35; ETA: 2:34:18; LR: 7.862e-05; cls_loss: 0.0602, cls_loss_aux: 0.0691, ptc_loss: 0.1200, spacial_bce_loss: 0.4704..., network_sim_loss: 0.0000... , CL: 0.0000... 
2024-07-29 12:58:09,084 - test_du_instance.py - INFO: Iter: 3200; Elasped: 1:38:42; ETA: 2:28:03; LR: 7.579e-05; cls_loss: 0.0632, cls_loss_aux: 0.0717, ptc_loss: 0.1053, spacial_bce_loss: 0.0772..., network_sim_loss: 0.0000... , CL: 2.0387... 
2024-07-29 13:04:15,409 - test_du_instance.py - INFO: Iter: 3400; Elasped: 1:44:48; ETA: 2:21:47; LR: 7.294e-05; cls_loss: 0.0611, cls_loss_aux: 0.0721, ptc_loss: 0.1081, spacial_bce_loss: 0.0310..., network_sim_loss: 0.0000... , CL: 1.1598... 
2024-07-29 13:10:22,851 - test_du_instance.py - INFO: Iter: 3600; Elasped: 1:50:55; ETA: 2:15:33; LR: 7.008e-05; cls_loss: 0.0611, cls_loss_aux: 0.0711, ptc_loss: 0.1020, spacial_bce_loss: 0.0285..., network_sim_loss: 0.0000... , CL: 0.9844... 
2024-07-29 13:16:29,106 - test_du_instance.py - INFO: Iter: 3800; Elasped: 1:57:02; ETA: 2:09:21; LR: 6.721e-05; cls_loss: 0.0543, cls_loss_aux: 0.0595, ptc_loss: 0.0903, spacial_bce_loss: 0.0239..., network_sim_loss: 0.0000... , CL: 0.9459... 
2024-07-29 13:22:35,311 - test_du_instance.py - INFO: Iter: 4000; Elasped: 2:03:08; ETA: 2:03:08; LR: 6.432e-05; cls_loss: 0.0505, cls_loss_aux: 0.0595, ptc_loss: 0.0864, spacial_bce_loss: 0.0231..., network_sim_loss: 0.0000... , CL: 0.8641... 
2024-07-29 13:22:35,311 - test_du_instance.py - INFO: Validating...branch1
2024-07-29 13:25:29,333 - test_du_instance.py - INFO: val cls score: 0.923181
2024-07-29 13:25:29,333 - test_du_instance.py - INFO: 
+--------------+--------+---------+----------+
|    Class     |  CAM   | aux_CAM | Seg_Pred |
+==============+========+=========+==========+
| _background_ | 91.128 | 90.413  | 90.972   |
+--------------+--------+---------+----------+
| aeroplane    | 70.310 | 73.630  | 76.507   |
+--------------+--------+---------+----------+
| bicycle      | 42.384 | 40.198  | 42.138   |
+--------------+--------+---------+----------+
| bird         | 77.827 | 81.718  | 77.882   |
+--------------+--------+---------+----------+
| boat         | 59.743 | 62.617  | 57.572   |
+--------------+--------+---------+----------+
| bottle       | 71.853 | 60.640  | 72.126   |
+--------------+--------+---------+----------+
| bus          | 85.540 | 79.698  | 83.926   |
+--------------+--------+---------+----------+
| car          | 80.090 | 73.677  | 78.345   |
+--------------+--------+---------+----------+
| cat          | 85.729 | 80.173  | 83.436   |
+--------------+--------+---------+----------+
| chair        | 53.721 | 49.011  | 38.017   |
+--------------+--------+---------+----------+
| cow          | 87.471 | 77.131  | 76.719   |
+--------------+--------+---------+----------+
| diningtable  | 61.170 | 60.430  | 53.181   |
+--------------+--------+---------+----------+
| dog          | 86.430 | 82.912  | 79.985   |
+--------------+--------+---------+----------+
| horse        | 85.805 | 79.751  | 78.587   |
+--------------+--------+---------+----------+
| motorbike    | 76.237 | 77.475  | 73.313   |
+--------------+--------+---------+----------+
| person       | 79.320 | 78.285  | 79.545   |
+--------------+--------+---------+----------+
| pottedplant  | 61.995 | 58.566  | 56.067   |
+--------------+--------+---------+----------+
| sheep        | 86.305 | 87.880  | 84.985   |
+--------------+--------+---------+----------+
| sofa         | 58.339 | 72.207  | 49.162   |
+--------------+--------+---------+----------+
| train        | 62.711 | 57.962  | 60.743   |
+--------------+--------+---------+----------+
| tvmonitor    | 58.754 | 62.300  | 58.212   |
+--------------+--------+---------+----------+
| mIoU         | 72.517 | 70.794  | 69.115   |
+--------------+--------+---------+----------+
2024-07-29 13:25:29,333 - test_du_instance.py - INFO: Validating...branch2
2024-07-29 13:28:23,547 - test_du_instance.py - INFO: val cls score: 0.919223
2024-07-29 13:28:23,548 - test_du_instance.py - INFO: 
+--------------+--------+---------+----------+
|    Class     |  CAM   | aux_CAM | Seg_Pred |
+==============+========+=========+==========+
| _background_ | 90.607 | 90.120  | 90.571   |
+--------------+--------+---------+----------+
| aeroplane    | 82.975 | 78.557  | 74.058   |
+--------------+--------+---------+----------+
| bicycle      | 46.327 | 41.559  | 38.812   |
+--------------+--------+---------+----------+
| bird         | 82.125 | 82.574  | 80.501   |
+--------------+--------+---------+----------+
| boat         | 60.157 | 56.709  | 56.033   |
+--------------+--------+---------+----------+
| bottle       | 77.626 | 72.491  | 73.974   |
+--------------+--------+---------+----------+
| bus          | 85.270 | 81.204  | 85.325   |
+--------------+--------+---------+----------+
| car          | 80.352 | 69.156  | 76.931   |
+--------------+--------+---------+----------+
| cat          | 84.732 | 83.318  | 85.439   |
+--------------+--------+---------+----------+
| chair        | 44.086 | 46.663  | 37.157   |
+--------------+--------+---------+----------+
| cow          | 86.735 | 81.931  | 83.748   |
+--------------+--------+---------+----------+
| diningtable  | 56.640 | 57.103  | 54.343   |
+--------------+--------+---------+----------+
| dog          | 82.324 | 82.625  | 82.886   |
+--------------+--------+---------+----------+
| horse        | 83.223 | 75.266  | 80.294   |
+--------------+--------+---------+----------+
| motorbike    | 74.785 | 74.801  | 70.843   |
+--------------+--------+---------+----------+
| person       | 73.098 | 76.399  | 79.112   |
+--------------+--------+---------+----------+
| pottedplant  | 58.651 | 49.568  | 51.132   |
+--------------+--------+---------+----------+
| sheep        | 84.202 | 84.436  | 84.116   |
+--------------+--------+---------+----------+
| sofa         | 56.264 | 67.820  | 45.828   |
+--------------+--------+---------+----------+
| train        | 64.498 | 61.202  | 62.632   |
+--------------+--------+---------+----------+
| tvmonitor    | 62.369 | 62.988  | 54.262   |
+--------------+--------+---------+----------+
| mIoU         | 72.240 | 70.309  | 68.952   |
+--------------+--------+---------+----------+
2024-07-29 13:34:30,064 - test_du_instance.py - INFO: Iter: 4200; Elasped: 2:15:03; ETA: 2:02:11; LR: 6.142e-05; cls_loss: 0.0559, cls_loss_aux: 0.0613, ptc_loss: 0.0937, spacial_bce_loss: 0.0133..., network_sim_loss: 0.0000... , CL: 0.9165... 
2024-07-29 13:40:35,933 - test_du_instance.py - INFO: Iter: 4400; Elasped: 2:21:08; ETA: 1:55:28; LR: 5.850e-05; cls_loss: 0.0525, cls_loss_aux: 0.0579, ptc_loss: 0.0876, spacial_bce_loss: 0.0114..., network_sim_loss: 0.0000... , CL: 0.7920... 
2024-07-29 13:46:42,889 - test_du_instance.py - INFO: Iter: 4600; Elasped: 2:27:15; ETA: 1:48:50; LR: 5.557e-05; cls_loss: 0.0489, cls_loss_aux: 0.0506, ptc_loss: 0.0770, spacial_bce_loss: 0.0110..., network_sim_loss: 0.0000... , CL: 0.6730... 
2024-07-29 13:52:49,117 - test_du_instance.py - INFO: Iter: 4800; Elasped: 2:33:22; ETA: 1:42:14; LR: 5.262e-05; cls_loss: 0.0471, cls_loss_aux: 0.0479, ptc_loss: 0.0860, spacial_bce_loss: 0.0092..., network_sim_loss: 0.0000... , CL: 0.6176... 
2024-07-29 13:58:54,920 - test_du_instance.py - INFO: Iter: 5000; Elasped: 2:39:27; ETA: 1:35:40; LR: 4.965e-05; cls_loss: 0.0422, cls_loss_aux: 0.0451, ptc_loss: 0.0791, spacial_bce_loss: 0.0074..., network_sim_loss: 0.0000... , CL: 0.6619... 
2024-07-29 14:05:00,758 - test_du_instance.py - INFO: Iter: 5200; Elasped: 2:45:33; ETA: 1:29:08; LR: 4.666e-05; cls_loss: 0.0526, cls_loss_aux: 0.0546, ptc_loss: 0.0945, spacial_bce_loss: 0.0095..., network_sim_loss: 0.0000... , CL: 0.6416... 
2024-07-29 14:11:07,627 - test_du_instance.py - INFO: Iter: 5400; Elasped: 2:51:40; ETA: 1:22:39; LR: 4.365e-05; cls_loss: 0.0464, cls_loss_aux: 0.0467, ptc_loss: 0.0806, spacial_bce_loss: 0.0079..., network_sim_loss: 0.0000... , CL: 0.5517... 
2024-07-29 14:17:13,727 - test_du_instance.py - INFO: Iter: 5600; Elasped: 2:57:46; ETA: 1:16:11; LR: 4.062e-05; cls_loss: 0.0461, cls_loss_aux: 0.0477, ptc_loss: 0.0840, spacial_bce_loss: 0.0111..., network_sim_loss: 0.0000... , CL: 0.7244... 
2024-07-29 14:23:19,878 - test_du_instance.py - INFO: Iter: 5800; Elasped: 3:03:52; ETA: 1:09:44; LR: 3.756e-05; cls_loss: 0.0503, cls_loss_aux: 0.0494, ptc_loss: 0.0757, spacial_bce_loss: 0.0104..., network_sim_loss: 0.0000... , CL: 0.7353... 
2024-07-29 14:29:26,092 - test_du_instance.py - INFO: Iter: 6000; Elasped: 3:09:59; ETA: 1:03:19; LR: 3.448e-05; cls_loss: 0.0495, cls_loss_aux: 0.0470, ptc_loss: 0.0867, spacial_bce_loss: 0.0095..., network_sim_loss: 0.0000... , CL: 0.5880... 
2024-07-29 14:29:26,092 - test_du_instance.py - INFO: Validating...branch1
2024-07-29 14:32:20,197 - test_du_instance.py - INFO: val cls score: 0.916797
2024-07-29 14:32:20,198 - test_du_instance.py - INFO: 
+--------------+--------+---------+----------+
|    Class     |  CAM   | aux_CAM | Seg_Pred |
+==============+========+=========+==========+
| _background_ | 91.683 | 90.518  | 91.296   |
+--------------+--------+---------+----------+
| aeroplane    | 76.465 | 78.969  | 77.757   |
+--------------+--------+---------+----------+
| bicycle      | 40.889 | 40.369  | 39.699   |
+--------------+--------+---------+----------+
| bird         | 78.678 | 82.073  | 77.393   |
+--------------+--------+---------+----------+
| boat         | 64.609 | 60.931  | 63.196   |
+--------------+--------+---------+----------+
| bottle       | 73.677 | 70.488  | 74.412   |
+--------------+--------+---------+----------+
| bus          | 88.086 | 81.895  | 87.547   |
+--------------+--------+---------+----------+
| car          | 84.230 | 76.337  | 81.664   |
+--------------+--------+---------+----------+
| cat          | 85.543 | 79.332  | 85.544   |
+--------------+--------+---------+----------+
| chair        | 54.148 | 48.078  | 42.292   |
+--------------+--------+---------+----------+
| cow          | 87.447 | 82.189  | 85.934   |
+--------------+--------+---------+----------+
| diningtable  | 66.085 | 58.345  | 60.392   |
+--------------+--------+---------+----------+
| dog          | 85.045 | 80.045  | 82.947   |
+--------------+--------+---------+----------+
| horse        | 84.146 | 74.681  | 82.955   |
+--------------+--------+---------+----------+
| motorbike    | 79.185 | 78.350  | 73.065   |
+--------------+--------+---------+----------+
| person       | 79.836 | 77.120  | 78.462   |
+--------------+--------+---------+----------+
| pottedplant  | 62.371 | 60.695  | 56.173   |
+--------------+--------+---------+----------+
| sheep        | 86.270 | 87.197  | 85.305   |
+--------------+--------+---------+----------+
| sofa         | 60.913 | 72.345  | 48.591   |
+--------------+--------+---------+----------+
| train        | 64.626 | 59.460  | 63.554   |
+--------------+--------+---------+----------+
| tvmonitor    | 62.824 | 65.057  | 61.585   |
+--------------+--------+---------+----------+
| mIoU         | 74.131 | 71.642  | 71.417   |
+--------------+--------+---------+----------+
2024-07-29 14:32:20,198 - test_du_instance.py - INFO: Validating...branch2
2024-07-29 14:35:14,440 - test_du_instance.py - INFO: val cls score: 0.922339
2024-07-29 14:35:14,440 - test_du_instance.py - INFO: 
+--------------+--------+---------+----------+
|    Class     |  CAM   | aux_CAM | Seg_Pred |
+==============+========+=========+==========+
| _background_ | 90.323 | 90.320  | 91.487   |
+--------------+--------+---------+----------+
| aeroplane    | 85.087 | 82.905  | 79.727   |
+--------------+--------+---------+----------+
| bicycle      | 44.087 | 40.667  | 38.787   |
+--------------+--------+---------+----------+
| bird         | 84.510 | 84.642  | 81.047   |
+--------------+--------+---------+----------+
| boat         | 64.619 | 58.479  | 61.858   |
+--------------+--------+---------+----------+
| bottle       | 78.009 | 74.213  | 76.490   |
+--------------+--------+---------+----------+
| bus          | 87.306 | 84.337  | 87.348   |
+--------------+--------+---------+----------+
| car          | 78.602 | 69.268  | 79.119   |
+--------------+--------+---------+----------+
| cat          | 79.305 | 81.076  | 85.202   |
+--------------+--------+---------+----------+
| chair        | 43.010 | 47.310  | 42.579   |
+--------------+--------+---------+----------+
| cow          | 81.509 | 79.746  | 86.577   |
+--------------+--------+---------+----------+
| diningtable  | 52.945 | 56.740  | 60.321   |
+--------------+--------+---------+----------+
| dog          | 78.992 | 78.406  | 81.993   |
+--------------+--------+---------+----------+
| horse        | 81.654 | 78.488  | 80.282   |
+--------------+--------+---------+----------+
| motorbike    | 73.731 | 74.595  | 73.036   |
+--------------+--------+---------+----------+
| person       | 69.382 | 75.923  | 78.130   |
+--------------+--------+---------+----------+
| pottedplant  | 65.170 | 56.079  | 63.233   |
+--------------+--------+---------+----------+
| sheep        | 81.028 | 85.397  | 84.868   |
+--------------+--------+---------+----------+
| sofa         | 55.016 | 72.080  | 48.939   |
+--------------+--------+---------+----------+
| train        | 65.311 | 61.548  | 64.294   |
+--------------+--------+---------+----------+
| tvmonitor    | 67.699 | 64.911  | 60.242   |
+--------------+--------+---------+----------+
| mIoU         | 71.776 | 71.292  | 71.693   |
+--------------+--------+---------+----------+
2024-07-29 14:41:22,340 - test_du_instance.py - INFO: Iter: 6200; Elasped: 3:21:55; ETA: 0:58:37; LR: 3.136e-05; cls_loss: 0.0422, cls_loss_aux: 0.0410, ptc_loss: 0.0727, spacial_bce_loss: 0.0072..., network_sim_loss: 0.0000... , CL: 0.4286... 
2024-07-29 14:47:28,680 - test_du_instance.py - INFO: Iter: 6400; Elasped: 3:28:01; ETA: 0:52:00; LR: 2.821e-05; cls_loss: 0.0426, cls_loss_aux: 0.0391, ptc_loss: 0.0762, spacial_bce_loss: 0.0070..., network_sim_loss: 0.0000... , CL: 0.5369... 
2024-07-29 14:53:34,837 - test_du_instance.py - INFO: Iter: 6600; Elasped: 3:34:07; ETA: 0:45:25; LR: 2.501e-05; cls_loss: 0.0360, cls_loss_aux: 0.0327, ptc_loss: 0.0672, spacial_bce_loss: 0.0055..., network_sim_loss: 0.0000... , CL: 0.4877... 
2024-07-29 14:59:40,706 - test_du_instance.py - INFO: Iter: 6800; Elasped: 3:40:13; ETA: 0:38:51; LR: 2.178e-05; cls_loss: 0.0399, cls_loss_aux: 0.0362, ptc_loss: 0.0697, spacial_bce_loss: 0.0073..., network_sim_loss: 0.0000... , CL: 0.5683... 
2024-07-29 15:05:46,511 - test_du_instance.py - INFO: Iter: 7000; Elasped: 3:46:19; ETA: 0:32:19; LR: 1.848e-05; cls_loss: 0.0393, cls_loss_aux: 0.0348, ptc_loss: 0.0773, spacial_bce_loss: 0.0061..., network_sim_loss: 0.0000... , CL: 0.6266... 
2024-07-29 15:11:53,581 - test_du_instance.py - INFO: Iter: 7200; Elasped: 3:52:26; ETA: 0:25:49; LR: 1.512e-05; cls_loss: 0.0325, cls_loss_aux: 0.0284, ptc_loss: 0.0744, spacial_bce_loss: 0.0061..., network_sim_loss: 0.0000... , CL: 0.4930... 
2024-07-29 15:18:00,068 - test_du_instance.py - INFO: Iter: 7400; Elasped: 3:58:33; ETA: 0:19:20; LR: 1.168e-05; cls_loss: 0.0319, cls_loss_aux: 0.0268, ptc_loss: 0.0709, spacial_bce_loss: 0.0062..., network_sim_loss: 0.0000... , CL: 0.5272... 
2024-07-29 15:24:06,092 - test_du_instance.py - INFO: Iter: 7600; Elasped: 4:04:39; ETA: 0:12:52; LR: 8.114e-06; cls_loss: 0.0394, cls_loss_aux: 0.0325, ptc_loss: 0.0747, spacial_bce_loss: 0.0065..., network_sim_loss: 0.0000... , CL: 0.4728... 
2024-07-29 15:30:12,905 - test_du_instance.py - INFO: Iter: 7800; Elasped: 4:10:45; ETA: 0:06:25; LR: 4.358e-06; cls_loss: 0.0340, cls_loss_aux: 0.0270, ptc_loss: 0.0750, spacial_bce_loss: 0.0059..., network_sim_loss: 0.0000... , CL: 0.5092... 
2024-07-29 15:36:19,961 - test_du_instance.py - INFO: Iter: 8000; Elasped: 4:16:52; ETA: 0:00:00; LR: 3.685e-08; cls_loss: 0.0354, cls_loss_aux: 0.0279, ptc_loss: 0.0703, spacial_bce_loss: 0.0054..., network_sim_loss: 0.0000... , CL: 0.4651... 
2024-07-29 15:36:19,961 - test_du_instance.py - INFO: Validating...branch1
2024-07-29 15:39:14,776 - test_du_instance.py - INFO: val cls score: 0.931655
2024-07-29 15:39:14,776 - test_du_instance.py - INFO: 
+--------------+--------+---------+----------+
|    Class     |  CAM   | aux_CAM | Seg_Pred |
+==============+========+=========+==========+
| _background_ | 91.805 | 90.354  | 91.415   |
+--------------+--------+---------+----------+
| aeroplane    | 82.458 | 81.185  | 84.554   |
+--------------+--------+---------+----------+
| bicycle      | 40.204 | 39.553  | 39.299   |
+--------------+--------+---------+----------+
| bird         | 82.554 | 81.760  | 83.740   |
+--------------+--------+---------+----------+
| boat         | 68.398 | 64.700  | 67.325   |
+--------------+--------+---------+----------+
| bottle       | 76.549 | 71.505  | 77.771   |
+--------------+--------+---------+----------+
| bus          | 88.180 | 82.825  | 87.719   |
+--------------+--------+---------+----------+
| car          | 82.799 | 74.867  | 80.485   |
+--------------+--------+---------+----------+
| cat          | 82.188 | 76.576  | 83.172   |
+--------------+--------+---------+----------+
| chair        | 57.401 | 48.106  | 45.887   |
+--------------+--------+---------+----------+
| cow          | 86.196 | 79.728  | 85.474   |
+--------------+--------+---------+----------+
| diningtable  | 61.676 | 58.669  | 60.424   |
+--------------+--------+---------+----------+
| dog          | 80.837 | 75.068  | 79.467   |
+--------------+--------+---------+----------+
| horse        | 84.129 | 74.570  | 83.054   |
+--------------+--------+---------+----------+
| motorbike    | 78.962 | 75.796  | 75.937   |
+--------------+--------+---------+----------+
| person       | 78.286 | 76.430  | 76.351   |
+--------------+--------+---------+----------+
| pottedplant  | 63.950 | 63.481  | 58.342   |
+--------------+--------+---------+----------+
| sheep        | 87.647 | 87.671  | 86.566   |
+--------------+--------+---------+----------+
| sofa         | 64.923 | 72.835  | 51.833   |
+--------------+--------+---------+----------+
| train        | 63.010 | 59.146  | 61.376   |
+--------------+--------+---------+----------+
| tvmonitor    | 65.656 | 65.475  | 65.040   |
+--------------+--------+---------+----------+
| mIoU         | 74.657 | 71.443  | 72.630   |
+--------------+--------+---------+----------+
2024-07-29 15:39:14,776 - test_du_instance.py - INFO: Validating...branch2
2024-07-29 15:42:09,281 - test_du_instance.py - INFO: val cls score: 0.925317
2024-07-29 15:42:09,281 - test_du_instance.py - INFO: 
+--------------+--------+---------+----------+
|    Class     |  CAM   | aux_CAM | Seg_Pred |
+==============+========+=========+==========+
| _background_ | 89.598 | 90.133  | 91.606   |
+--------------+--------+---------+----------+
| aeroplane    | 83.933 | 83.901  | 84.383   |
+--------------+--------+---------+----------+
| bicycle      | 43.682 | 41.421  | 39.367   |
+--------------+--------+---------+----------+
| bird         | 84.820 | 84.460  | 83.531   |
+--------------+--------+---------+----------+
| boat         | 68.431 | 60.678  | 65.981   |
+--------------+--------+---------+----------+
| bottle       | 76.591 | 73.946  | 78.437   |
+--------------+--------+---------+----------+
| bus          | 85.375 | 83.747  | 88.504   |
+--------------+--------+---------+----------+
| car          | 75.629 | 67.350  | 79.638   |
+--------------+--------+---------+----------+
| cat          | 77.236 | 79.780  | 82.790   |
+--------------+--------+---------+----------+
| chair        | 45.702 | 52.078  | 44.658   |
+--------------+--------+---------+----------+
| cow          | 78.448 | 77.279  | 85.746   |
+--------------+--------+---------+----------+
| diningtable  | 51.969 | 57.415  | 62.105   |
+--------------+--------+---------+----------+
| dog          | 72.365 | 74.524  | 79.701   |
+--------------+--------+---------+----------+
| horse        | 78.181 | 75.635  | 81.372   |
+--------------+--------+---------+----------+
| motorbike    | 71.722 | 72.858  | 74.820   |
+--------------+--------+---------+----------+
| person       | 63.773 | 75.206  | 77.388   |
+--------------+--------+---------+----------+
| pottedplant  | 65.401 | 59.051  | 64.872   |
+--------------+--------+---------+----------+
| sheep        | 81.389 | 84.915  | 85.087   |
+--------------+--------+---------+----------+
| sofa         | 59.723 | 73.390  | 55.246   |
+--------------+--------+---------+----------+
| train        | 62.845 | 59.452  | 62.698   |
+--------------+--------+---------+----------+
| tvmonitor    | 69.385 | 66.438  | 64.711   |
+--------------+--------+---------+----------+
| mIoU         | 70.771 | 71.127  | 72.983   |
+--------------+--------+---------+----------+

single branch train cam_scales result:
+--------------+--------+---------+
|    Class     |  cam   | aux_cam |
+==============+========+=========+
| _background_ | 92.179 | 91.103  |
+--------------+--------+---------+
| aeroplane    | 83.202 | 84.901  |
+--------------+--------+---------+
| bicycle      | 48.779 | 47.472  |
+--------------+--------+---------+
| bird         | 84.380 | 85.591  |
+--------------+--------+---------+
| boat         | 72.830 | 65.715  |
+--------------+--------+---------+
| bottle       | 80.355 | 73.007  |
+--------------+--------+---------+
| bus          | 85.407 | 81.679  |
+--------------+--------+---------+
| car          | 82.720 | 72.282  |
+--------------+--------+---------+
| cat          | 82.351 | 77.142  |
+--------------+--------+---------+
| chair        | 57.186 | 55.759  |
+--------------+--------+---------+
| cow          | 86.728 | 80.156  |
+--------------+--------+---------+
| diningtable  | 70.528 | 67.176  |
+--------------+--------+---------+
| dog          | 83.952 | 77.793  |
+--------------+--------+---------+
| horse        | 83.542 | 79.321  |
+--------------+--------+---------+
| motorbike    | 82.980 | 81.131  |
+--------------+--------+---------+
| person       | 80.994 | 78.237  |
+--------------+--------+---------+
| pottedplant  | 67.352 | 63.172  |
+--------------+--------+---------+
| sheep        | 89.906 | 88.450  |
+--------------+--------+---------+
| sofa         | 68.376 | 81.234  |
+--------------+--------+---------+
| train        | 63.745 | 59.942  |
+--------------+--------+---------+
| tvmonitor    | 64.647 | 66.581  |
+--------------+--------+---------+
| mIoU         | 76.768 | 74.183  |
+--------------+--------+---------+

single branch val cam_scales result:
+--------------+--------+---------+
|    Class     |  cam   | aux_cam |
+==============+========+=========+
| _background_ | 92.345 | 90.970  |
+--------------+--------+---------+
| aeroplane    | 85.491 | 83.555  |
+--------------+--------+---------+
| bicycle      | 42.915 | 41.840  |
+--------------+--------+---------+
| bird         | 84.752 | 84.011  |
+--------------+--------+---------+
| boat         | 70.043 | 66.295  |
+--------------+--------+---------+
| bottle       | 77.792 | 72.909  |
+--------------+--------+---------+
| bus          | 88.786 | 82.905  |
+--------------+--------+---------+
| car          | 83.521 | 75.435  |
+--------------+--------+---------+
| cat          | 83.691 | 77.977  |
+--------------+--------+---------+
| chair        | 58.673 | 50.224  |
+--------------+--------+---------+
| cow          | 88.202 | 81.348  |
+--------------+--------+---------+
| diningtable  | 62.396 | 58.991  |
+--------------+--------+---------+
| dog          | 82.167 | 76.446  |
+--------------+--------+---------+
| horse        | 86.245 | 77.291  |
+--------------+--------+---------+
| motorbike    | 81.008 | 79.104  |
+--------------+--------+---------+
| person       | 80.539 | 79.088  |
+--------------+--------+---------+
| pottedplant  | 64.525 | 65.222  |
+--------------+--------+---------+
| sheep        | 89.619 | 88.592  |
+--------------+--------+---------+
| sofa         | 65.441 | 73.925  |
+--------------+--------+---------+
| train        | 64.202 | 60.864  |
+--------------+--------+---------+
| tvmonitor    | 65.043 | 65.643  |
+--------------+--------+---------+
| mIoU         | 76.067 | 72.982  |
+--------------+--------+---------+


du branch train cam_scales result:
+--------------+--------+---------+
|    Class     |  cam   | aux_cam |
+==============+========+=========+
| _background_ | 92.289 | 91.353  |
+--------------+--------+---------+
| aeroplane    | 85.380 | 86.131  |
+--------------+--------+---------+
| bicycle      | 50.455 | 47.296  |
+--------------+--------+---------+
| bird         | 86.360 | 85.975  |
+--------------+--------+---------+
| boat         | 75.026 | 66.799  |
+--------------+--------+---------+
| bottle       | 83.066 | 76.175  |
+--------------+--------+---------+
| bus          | 86.200 | 82.240  |
+--------------+--------+---------+
| car          | 82.914 | 71.623  |
+--------------+--------+---------+
| cat          | 81.958 | 78.747  |
+--------------+--------+---------+
| chair        | 58.056 | 57.448  |
+--------------+--------+---------+
| cow          | 86.312 | 80.608  |
+--------------+--------+---------+
| diningtable  | 71.457 | 68.015  |
+--------------+--------+---------+
| dog          | 82.845 | 79.075  |
+--------------+--------+---------+
| horse        | 83.605 | 78.951  |
+--------------+--------+---------+
| motorbike    | 83.016 | 80.774  |
+--------------+--------+---------+
| person       | 79.806 | 79.628  |
+--------------+--------+---------+
| pottedplant  | 69.457 | 62.276  |
+--------------+--------+---------+
| sheep        | 89.886 | 88.705  |
+--------------+--------+---------+
| sofa         | 68.394 | 82.671  |
+--------------+--------+---------+
| train        | 63.983 | 59.951  |
+--------------+--------+---------+
| tvmonitor    | 66.497 | 67.781  |
+--------------+--------+---------+
| mIoU         | 77.474 | 74.868  |
+--------------+--------+---------+

du branch val cam_scales result:
+--------------+--------+---------+
|    Class     |  cam   | aux_cam |
+==============+========+=========+
| _background_ | 92.253 | 91.296  |
+--------------+--------+---------+
| aeroplane    | 87.316 | 85.503  |
+--------------+--------+---------+
| bicycle      | 44.623 | 42.808  |
+--------------+--------+---------+
| bird         | 86.592 | 85.913  |
+--------------+--------+---------+
| boat         | 71.042 | 67.236  |
+--------------+--------+---------+
| bottle       | 79.811 | 74.853  |
+--------------+--------+---------+
| bus          | 89.181 | 83.984  |
+--------------+--------+---------+
| car          | 83.159 | 75.103  |
+--------------+--------+---------+
| cat          | 82.941 | 79.439  |
+--------------+--------+---------+
| chair        | 59.382 | 52.891  |
+--------------+--------+---------+
| cow          | 86.960 | 81.975  |
+--------------+--------+---------+
| diningtable  | 61.697 | 59.766  |
+--------------+--------+---------+
| dog          | 80.783 | 77.152  |
+--------------+--------+---------+
| horse        | 85.430 | 78.328  |
+--------------+--------+---------+
| motorbike    | 79.867 | 78.926  |
+--------------+--------+---------+
| person       | 78.948 | 80.277  |
+--------------+--------+---------+
| pottedplant  | 66.329 | 66.738  |
+--------------+--------+---------+
| sheep        | 88.812 | 88.353  |
+--------------+--------+---------+
| sofa         | 63.877 | 75.349  |
+--------------+--------+---------+
| train        | 64.390 | 61.286  |
+--------------+--------+---------+
| tvmonitor    | 68.863 | 67.390  |
+--------------+--------+---------+
| mIoU         | 76.298 | 74.027  |
+--------------+--------+---------+

crf result:
+--------------+---------+
|    Class     | seg_crf |
+==============+=========+
| _background_ | 92.567  |
+--------------+---------+
| aeroplane    | 88.290  |
+--------------+---------+
| bicycle      | 43.809  |
+--------------+---------+
| bird         | 86.718  |
+--------------+---------+
| boat         | 68.467  |
+--------------+---------+
| bottle       | 81.106  |
+--------------+---------+
| bus          | 88.627  |
+--------------+---------+
| car          | 81.760  |
+--------------+---------+
| cat          | 86.932  |
+--------------+---------+
| chair        | 48.856  |
+--------------+---------+
| cow          | 89.801  |
+--------------+---------+
| diningtable  | 66.674  |
+--------------+---------+
| dog          | 82.897  |
+--------------+---------+
| horse        | 84.033  |
+--------------+---------+
| motorbike    | 76.694  |
+--------------+---------+
| person       | 80.459  |
+--------------+---------+
| pottedplant  | 67.929  |
+--------------+---------+
| sheep        | 90.179  |
+--------------+---------+
| sofa         | 56.331  |
+--------------+---------+
| train        | 63.667  |
+--------------+---------+
| tvmonitor    | 66.236  |
+--------------+---------+
| mIoU         | 75.811  |
+--------------+---------+
